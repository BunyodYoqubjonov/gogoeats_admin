"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[1586],{20776:function(e,n,t){t.d(n,{o:function(){return f}});var i=t(1413),a=t(29439),l=t(45987),r=t(47313),o=t(84762),u=t(72652),c=t(12279),d=t.n(c),s=t(46417),v=["fetchOptions","refetch","debounceTimeout"],f=function(e){var n=e.fetchOptions,t=e.refetch,c=void 0!==t&&t,f=e.debounceTimeout,m=void 0===f?400:f,p=(0,l.Z)(e,v),Z=(0,r.useState)(!1),h=(0,a.Z)(Z,2),x=h[0],j=h[1],g=(0,r.useState)([]),y=(0,a.Z)(g,2),b=y[0],k=y[1],w=(0,r.useMemo)((function(){return d()((function(e){k([]),j(!0),n(e).then((function(e){k(e),j(!1)}))}),m)}),[]);return(0,s.jsx)(o.Z,(0,i.Z)({showSearch:!0,labelInValue:!0,filterTreeNode:function(e,n){var t;return null===(t=n.label)||void 0===t?void 0:t.localeCompare(e)},treeLine:!0,onSearch:function(e){return w(e)},treeData:x?[]:b,treeDefaultExpandAll:!0,onFocus:function(){b.length&&!c||(j(!0),n().then((function(e){k(e),j(!1)})))},notFoundContent:x?(0,s.jsx)(u.Z,{size:"small"}):"no results"},p))}},55940:function(e,n,t){t.d(n,{Z:function(){return v}});var i=t(1413),a=t(45987),l=(t(47313),t(59491)),r=t(47515),o=t(23560),u=t(24511),c=t(79492),d=t(46417),s=["size","onClick","type"];function v(e){var n=e.size,t=void 0===n?"":n,v=e.onClick,f=e.type,m=void 0===f?"default":f,p=(0,a.Z)(e,s),Z=(0,u.$)().t,h=(0,c.Z)().isDemo;return(0,d.jsx)(l.Z,(0,i.Z)({size:t,icon:(0,d.jsx)(r.Z,{}),onClick:function(e){h?o.Am.warning(Z("cannot.work.demo")):v(e)},type:m},p))}},73431:function(e,n,t){var i=t(47313),a=t(39180),l=t(2717),r=t(28830),o=t(60535),u=t(46417);n.Z=function(){var e=(0,l.I0)(),n=(0,l.v9)((function(e){return e.formLang}),l.wU),t=n.languages,c=n.defaultLang;(0,i.useEffect)((function(){o.Z.getAllActive().then((function(n){var t=n.data;e((0,r.dc)(t)),e((0,r.mh)(t.find((function(e){return 1===e.default})).locale))}))}),[]);return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(a.ZP.Group,{value:c,onChange:function(n){var t=n.target.value;e((0,r.mh)(t))},className:"float-right",buttonStyle:"solid",children:null===t||void 0===t?void 0:t.map((function(e){return(0,u.jsx)(a.ZP.Button,{value:e.locale,children:e.title},e.id)}))})})}},13622:function(e,n,t){t.d(n,{R:function(){return f}});var i=t(1413),a=t(29439),l=t(45987),r=t(47313),o=t(12279),u=t.n(o),c=t(74294),d=t(72652),s=t(46417),v=["fetchOptions","debounceTimeout","refetch"],f=function(e){var n=e.fetchOptions,t=e.debounceTimeout,o=void 0===t?400:t,f=(e.refetch,(0,l.Z)(e,v)),m=(0,r.useState)(!1),p=(0,a.Z)(m,2),Z=p[0],h=p[1],x=(0,r.useState)([]),j=(0,a.Z)(x,2),g=j[0],y=j[1],b=(0,r.useMemo)((function(){return u()((function(e){y([]),h(!0),n(e).then((function(e){y(e),h(!1)}))}),o)}),[n,o]);return(0,s.jsx)(c.Z,(0,i.Z)((0,i.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,onClear:function(){return b("")},filterOption:!1,onSearch:b,notFoundContent:Z?(0,s.jsx)(d.Z,{size:"small"}):"no results"},f),{},{options:g,onFocus:function(){b("")}}))}},89281:function(e,n,t){t.d(n,{h:function(){return f}});var i=t(1413),a=t(29439),l=t(45987),r=t(47313),o=t(12279),u=t.n(o),c=t(74294),d=t(72652),s=t(46417),v=["fetchOptions","debounceTimeout","onClear"],f=function(e){var n=e.fetchOptions,t=e.debounceTimeout,o=void 0===t?400:t,f=e.onClear,m=(0,l.Z)(e,v),p=(0,r.useState)(!1),Z=(0,a.Z)(p,2),h=Z[0],x=Z[1],j=(0,r.useState)([]),g=(0,a.Z)(j,2),y=g[0],b=g[1],k=(0,r.useMemo)((function(){return u()((function(e){b([]),x(!0),n(e).then((function(e){b(e),x(!1)}))}),o)}),[n,o]);return(0,s.jsx)(c.Z,(0,i.Z)((0,i.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:k,onClear:function(){k(""),f&&f()},notFoundContent:h?(0,s.jsx)(d.Z,{size:"small"}):"no results"},m),{},{options:y,onFocus:function(){k("")}}))}},33724:function(e,n){n.Z=function(e){var n=[],t=e.length-1;return function i(a,l){for(var r=0,o=null===(u=e[l])||void 0===u?void 0:u.length;r<o;r++){var u,c=a.slice(0);c.push(e[l][r]),l===t?n.push(c):i(c,l+1)}}([],0),n}},75336:function(e,n,t){t.d(n,{Z:function(){return l}});var i=t(93433),a=t(4942);function l(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title",l=e.map((function(e){return(0,a.Z)({},e.locale,""===n["".concat(t,"[").concat(e.locale,"]")]?void 0:n["".concat(t,"[").concat(e.locale,"]")])}));return Object.assign.apply(Object,[{}].concat((0,i.Z)(l)))}},71136:function(e,n,t){t.d(n,{Z:function(){return l}});var i=t(29439),a=t(47313);function l(e,n){var t=(0,a.useState)(e),l=(0,i.Z)(t,2),r=l[0],o=l[1];return(0,a.useEffect)((function(){var t=setTimeout((function(){o(e)}),n);return function(){clearTimeout(t)}}),[e,n]),r}},16190:function(e,n,t){t.d(n,{Z:function(){return y}});var i=t(93433),a=t(4942),l=t(1413),r=t(29439),o=t(47313),u=t(10976),c=t(9274),d=t(59491),s=t(66672),v=t(24511),f=t(73431),m=t(2717),p=t(5170),Z=t(23560),h=t(97340),x=t(75336),j=t(51282),g=t(46417);function y(e){var n=e.modal,t=e.handleCancel,y=e.onSuccess,b=u.Z.useForm(),k=(0,r.Z)(b,1)[0],w=(0,v.$)().t,I=(0,m.I0)(),q=(0,o.useState)(!1),S=(0,r.Z)(q,2),C=S[0],_=S[1],N=(0,o.useState)(!1),P=(0,r.Z)(N,2),E=P[0],O=P[1],F=(0,m.v9)((function(e){return e.formLang}),m.wU),U=F.languages,L=F.defaultLang;function M(e){O(!0),p.Z.getGroupById(e).then((function(e){var n=e.data;k.setFieldsValue((0,l.Z)((0,l.Z)({},n),function(e){if(!e)return{};var n=e.translations,t=U.map((function(e){var t;return(0,a.Z)({},"title[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.title)}));return Object.assign.apply(Object,[{}].concat((0,i.Z)(t)))}(n)))})).finally((function(){return O(!1)}))}(0,o.useEffect)((function(){null!==n&&void 0!==n&&n.id&&M(n.id)}),[n]);return(0,g.jsx)(c.Z,{title:null!==n&&void 0!==n&&n.id?w("edit.extra.group"):w("add.extra.group"),visible:!!n,onCancel:t,footer:[(0,g.jsx)(d.Z,{type:"primary",onClick:function(){return k.submit()},loading:C,children:w("save")},"save-button-group"),(0,g.jsx)(d.Z,{type:"default",onClick:t,children:w("cancel")},"cancel-button-group")],children:E?(0,g.jsx)(j.Z,{}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"d-flex justify-content-end",children:(0,g.jsx)(f.Z,{})}),(0,g.jsx)(u.Z,{layout:"vertical",name:"extra-group",form:k,onFinish:function(e){var i={title:(0,x.Z)(U,e),type:"text"};null!==n&&void 0!==n&&n.id?function(e,n){_(!0),p.Z.updateGroup(e,n).then((function(){Z.Am.success(w("successfully.updated")),I((0,h.gw)()),t()})).finally((function(){return _(!1)}))}(null===n||void 0===n?void 0:n.id,i):function(e){_(!0),p.Z.createGroup(e).then((function(){Z.Am.success(w("successfully.created")),t(),I((0,h.gw)()),y&&y()})).finally((function(){return _(!1)}))}(i)},children:U.map((function(e){return(0,g.jsx)(u.Z.Item,{rules:[{required:e.locale===L,message:w("required")}],name:"title[".concat(e.locale,"]"),label:w("title"),hidden:e.locale!==L,children:(0,g.jsx)(s.Z,{placeholder:w("title")})},"title"+e.locale)}))})]})})}},21726:function(e,n,t){t.d(n,{Z:function(){return k}});var i=t(15861),a=t(1413),l=t(29439),r=t(87757),o=t.n(r),u=t(10976),c=t(66672),d=t(9274),s=t(59491),v=t(47313),f=t(8922),m=t(24511),p=t(2717),Z=t(23560),h=t(20503),x=t(8550),j=t(34319),g=t(5170),y=t(89281),b=t(46417);function k(e){var n=e.modal,t=e.handleCancel,r=e.onSuccess,k=e.groupId,w=u.Z.useForm(),I=(0,l.Z)(w,1)[0],q=(0,m.$)().t,S=(0,p.I0)(),C=(0,v.useState)(!1),_=(0,l.Z)(C,2),N=_[0],P=_[1],E=(0,v.useState)("text"),O=(0,l.Z)(E,2),F=O[0],U=O[1],L=(0,v.useState)(null),M=(0,l.Z)(L,2),A=M[0],V=M[1],T=(0,v.useState)(""),$=(0,l.Z)(T,2),G=$[0],W=$[1];(0,p.v9)((function(e){return e.extraGroup}),p.wU).extraGroups;(0,v.useEffect)((function(){if(null!==n&&void 0!==n&&n.id){var e,t,i;U(n.group.type);var l=(0,a.Z)((0,a.Z)({},n),{},{extra_group_id:{label:null===n||void 0===n||null===(e=n.group)||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===n||void 0===n||null===(i=n.group)||void 0===i?void 0:i.id},value:n.value});switch(n.group.type){case"color":W(n.value);break;case"image":V((0,x.Z)(n.value))}I.setFieldsValue(l)}k&&I.setFieldsValue({extra_group_id:{value:k}})}),[n,k]);function z(e,n){switch(e){case"color":return n.hex;case"text":return n;case"image":return n.name;default:return""}}function R(){return(R=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={perPage:10,active:1,search:n},console.log("search => ",t),e.abrupt("return",g.Z.getAllGroups(t).then((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n;return{value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,key:null===e||void 0===e?void 0:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,b.jsx)(d.Z,{title:null!==n&&void 0!==n&&n.id?q("edit.extra"):q("add.extra"),visible:!!n,onCancel:t,footer:[(0,b.jsx)(s.Z,{type:"primary",onClick:function(){return I.submit()},loading:N,children:q("save")}),(0,b.jsx)(s.Z,{type:"default",onClick:t,children:q("cancel")})],children:(0,b.jsxs)(u.Z,{name:"extra-form",layout:"vertical",form:I,onFinish:function(e){var i;console.log(e);var a={extra_group_id:null===e||void 0===e||null===(i=e.extra_group_id)||void 0===i?void 0:i.value,value:z(F,e.value)};null!==n&&void 0!==n&&n.id?function(e,n){P(!0),g.Z.updateValue(e,n).then((function(){Z.Am.success(q("successfully.updated")),t(),S((0,j.pZ)())})).finally((function(){return P(!1)}))}(n.id,a):function(e){P(!0),g.Z.createValue(e).then((function(){Z.Am.success(q("successfully.created")),t(),S((0,j.pZ)()),r&&r()})).finally((function(){return P(!1)}))}(a)},children:[(0,b.jsx)(u.Z.Item,{name:"extra_group_id",label:q("extra.group"),hidden:!!k,rules:[{required:!0,message:""}],children:(0,b.jsx)(y.h,{fetchOptions:function(e){return R.apply(this,arguments)}})}),(0,b.jsx)(u.Z.Item,{name:"value",label:q("value"),rules:[{required:!0,message:""}],children:function(e){switch(e){case"color":return(0,b.jsx)(f.xS,{onChangeComplete:function(e){return W(e.hex)},color:G,disableAlpha:!0});case"text":return(0,b.jsx)(c.Z,{placeholder:q("enter.extra.value")});case"image":return(0,b.jsx)(h.Z,{type:"extras",image:A,setImage:V,form:I,name:"value"});default:return""}}(F)})]})})}},47668:function(e,n,t){t.d(n,{Z:function(){return O}});var i=t(93433),a=t(1413),l=t(29439),r=t(47313),o=t(77181),u=t(10976),c=t(45705),d=t(59491),s=t(2717),v=t(17101),f=t(90954),m=t(24511),p=t(97890),Z=t(23560),h=t(3394),x=t(9274),j=t(66672),g=t(42346),y=t(66204),b=t(18074),k=t(5170),w=t(16190),I=t(82138),q=t(71136),S=t(46417),C=function(e){var n=e.open,t=e.onClose,i=e.selectedExtras,a=e.onSelect,o=(0,m.$)().t,u=(0,r.useState)([]),c=(0,l.Z)(u,2),s=c[0],v=c[1],f=(0,r.useState)(!1),p=(0,l.Z)(f,2),Z=p[0],h=p[1],C=(0,r.useState)(!1),_=(0,l.Z)(C,2),N=_[0],P=_[1],E=(0,r.useState)(""),O=(0,l.Z)(E,2),F=O[0],U=O[1],L=(0,q.Z)(F,500),M=(0,r.useState)(),A=(0,l.Z)(M,2),V=A[0],T=A[1],$=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;h(!0);var t={valid:!0,perPage:10,search:e,page:n};k.Z.getAllGroups(t).then((function(e){var n=e.data.map((function(e){var n;return{id:e.id,label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id,shop_id:e.shop_id}}));v(n),T(e.meta)})).finally((function(){return h(!1)}))};return(0,r.useEffect)((function(){n&&$(L)}),[n,L]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(x.Z,{visible:n,onCancel:function(){t(),U("")},footer:Z?null:(0,S.jsx)(d.Z,{type:"link",onClick:function(){return P(!0)},style:{paddingLeft:0},icon:(0,S.jsx)(I.Z,{}),children:o("add.new.extra")}),children:[(0,S.jsx)(j.Z,{className:"mt-3",value:F,onChange:function(e){return U(e.target.value)}}),(0,S.jsx)(g.ZP,{loading:Z,dataSource:s.filter((function(e){return!(null!==i&&void 0!==i&&i.some((function(n){return n.id===e.id})))})),renderItem:function(e){return(0,S.jsx)(g.ZP.Item,{extra:null!==e&&void 0!==e&&e.shop_id?null:(0,S.jsx)(y.Z,{children:o("admin")}),style:{cursor:"pointer"},onClick:function(){a(e)},children:e.label})}}),(0,S.jsx)(b.Z,{onChange:function(e){$(L,e)},current:null===V||void 0===V?void 0:V.current_page,total:null===V||void 0===V?void 0:V.total})]}),(0,S.jsx)(w.Z,{modal:N,handleCancel:function(){return P(!1)},onSuccess:function(){return $()}})]})},_=t(32697),N=t(98276),P=t(21726),E=function(e){var n=e.extra,t=e.onClose,i=e.onSelect,a=(0,m.$)().t,o=(0,r.useState)(!1),u=(0,l.Z)(o,2),c=u[0],s=u[1],v=(0,r.useState)([]),f=(0,l.Z)(v,2),p=f[0],Z=f[1],h=(0,r.useState)([]),j=(0,l.Z)(h,2),y=j[0],b=j[1],w=(0,r.useState)(!1),q=(0,l.Z)(w,2),C=q[0],E=q[1];function O(e){s(!0),k.Z.getGroupById(e).then((function(e){return Z(e.data.extra_values.map((function(e){return{label:e.value,value:e.id}})))})).finally((function(){s(!1)}))}return(0,r.useEffect)((function(){var e;null!==n&&void 0!==n&&n.value&&(O(n.value),b((null===n||void 0===n||null===(e=n.values)||void 0===e?void 0:e.map((function(e){return e.value})))||[]))}),[null===n||void 0===n?void 0:n.value]),console.log(n),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(x.Z,{visible:!!n,onCancel:t,footer:[(0,S.jsx)(d.Z,{onClick:t,children:a("cancel")}),!c&&p.length>0&&(0,S.jsx)(d.Z,{onClick:function(){var e=[];p.forEach((function(n){y.forEach((function(t){n.value===t&&e.push(n)}))})),i(null===n||void 0===n?void 0:n.value,e),t()},type:"primary",children:a("save")})],children:[(0,S.jsx)(_.Z.Group,{value:y,onChange:function(e){b(e)},className:"w-100",children:0!==(null===p||void 0===p?void 0:p.length)||c?(0,S.jsx)(g.ZP,{dataSource:p,loading:c,renderItem:function(e){return(0,S.jsx)(g.ZP.Item,{children:(0,S.jsx)(_.Z,{value:e.value,children:null===e||void 0===e?void 0:e.label})})}}):(0,S.jsx)(N.Z,{})}),c?null:(0,S.jsx)(d.Z,{type:"link",onClick:function(){return E(!0)},style:{paddingLeft:0},icon:(0,S.jsx)(I.Z,{}),children:a("add.new.extra")})]}),n&&(0,S.jsx)(P.Z,{modal:C,handleCancel:function(){return E(!1)},groupId:null===n||void 0===n?void 0:n.value,onSuccess:function(){return O(null===n||void 0===n?void 0:n.value)}})]})},O=function(e){var n,t=e.next,x=e.prev,j=e.isRequest,g=(0,m.$)().t,y=(0,s.I0)(),b=(0,p.UO)(),k=b.uuid,w=b.id,I=(0,p.s0)(),q=(0,s.v9)((function(e){return e.menu}),s.wU).activeMenu,_=(0,r.useState)(!1),N=(0,l.Z)(_,2),P=N[0],O=N[1],F=(0,r.useState)(!1),U=(0,l.Z)(F,2),L=U[0],M=U[1],A=(0,r.useState)((null===(n=q.data)||void 0===n?void 0:n.extras)||[]),V=(0,l.Z)(A,2),T=V[0],$=V[1],G=(0,r.useState)(null),W=(0,l.Z)(G,2),z=W[0],R=W[1],B=(0,r.useState)(!1),D=(0,l.Z)(B,2),K=D[0],H=D[1];return(0,S.jsx)(o.Z,{children:(0,S.jsxs)(u.Z,{layout:"vertical",initialValues:(0,a.Z)({},q.data),onFinish:function(){if(T.some((function(e){var n;return 0===(null===(n=e.values)||void 0===n?void 0:n.length)||!e.values})))Z.Am.error(g("please.select.at.least.1.extra.value.for.each.extra"));else{var e=T.map((function(e){return e.value}));if(e.sort((function(e,n){return e-n})),j)return y((0,f.nc)({activeMenu:q,data:(0,a.Z)((0,a.Z)({},q.data),{},{extras:T})})),void I("/product-request/".concat(w,"?step=2"),{state:{generate:K}});O(!0),v.Z.extras(k,{extras:e}).then((function(){y((0,f.nc)({activeMenu:q,data:(0,a.Z)((0,a.Z)({},q.data),{},{extras:T})})),t()})).finally((function(){return O(!1)}))}},children:[(0,S.jsx)(C,{open:L,onClose:function(){return M(!1)},selectedExtras:T,onSelect:function(e){H(!0),$((function(n){return[].concat((0,i.Z)(n),[e])})),M(!1)}}),(0,S.jsx)(E,{extra:z,onClose:function(){return R(null)},onSelect:function(e,n){H(!0),$((function(t){return t.map((function(t){if(t.value===e){var i=n.map((function(e){var n,t,i=null===(n=q.data)||void 0===n||null===(t=n.extras)||void 0===t?void 0:t.flatMap((function(e){return e.values})).find((function(n){return n.value===e.value}));return(0,a.Z)((0,a.Z)({},e),{},{stock_id:null===i||void 0===i?void 0:i.stock_id})}));return(0,a.Z)((0,a.Z)({},t),{},{values:i})}return t}))}))}}),(0,S.jsx)(c.Z,{className:"w-100",size:"middle",direction:"vertical",children:T.map((function(e){var n;return(0,S.jsxs)(c.Z,{className:"w-100",direction:"vertical",children:[(0,S.jsxs)(c.Z,{className:"w-100",wrap:!0,children:[(0,S.jsx)(d.Z,{onClick:function(){return R(e)},ghost:!0,type:"primary",children:null===e||void 0===e?void 0:e.label}),null===e||void 0===e||null===(n=e.values)||void 0===n?void 0:n.map((function(n){return(0,S.jsxs)("div",{className:"extra-value",children:[null===n||void 0===n?void 0:n.label," ",(0,S.jsx)("button",{onClick:function(){return t=e.value,i=n.value,H(!0),void $((function(e){return e.map((function(e){return e.value===t?(0,a.Z)((0,a.Z)({},e),{},{values:(null===e||void 0===e?void 0:e.values.filter((function(e){return e.value!==i})))||[]}):e}))}));var t,i},type:"button",className:"extra-clear",children:(0,S.jsx)(h.IOM,{})})]},n.value)}))]}),(0,S.jsx)(c.Z,{className:"w-100",style:{justifyContent:"flex-end"},children:(0,S.jsx)(d.Z,{danger:!0,onClick:function(){return n=e,H(!0),void $((function(e){return e.filter((function(e){return e.id!==n.id}))}));var n},type:"text",children:g("delete")})})]},e.id)}))}),(0,S.jsx)(d.Z,{onClick:function(){return M(!0)},className:"w-100 my-3",type:"dashed",children:g("add.extra")}),(0,S.jsxs)(c.Z,{className:"mt-3",children:[(0,S.jsx)(d.Z,{onClick:x,children:g("prev")}),(0,S.jsx)(d.Z,{type:"primary",htmlType:"submit",loading:P,children:g("next")})]})]})})}},78873:function(e,n,t){var i=t(1413),a=t(93433),l=t(4942),r=t(29439),o=t(47313),u=t(77181),c=t(83371),d=t(68197),s=t(59624),v=t(45705),f=t(59491),m=t(72652),p=t(2717),Z=t(97890),h=t(90954),x=t(95882),j=t(24511),g=t(17101),y=t(97421),b=t(23560),k=t(14349),w=t(46417);n.Z=function(e){var n,t,I,q,S,C,_,N,P,E,O,F,U,L=e.prev,M=e.isRequest,A=(0,j.$)().t,V=(0,p.v9)((function(e){return e.menu}),p.wU).activeMenu,T=(0,p.v9)((function(e){return e.formLang}),p.wU),$=T.defaultLang,G=T.languages,W=(0,Z.s0)(),z=(0,p.I0)(),R=(0,o.useState)({}),B=(0,r.Z)(R,2),D=B[0],K=B[1],H=(0,o.useState)(null),X=(0,r.Z)(H,2),J=X[0],Q=X[1],Y=(0,Z.UO)().uuid,ee=(0,o.useState)(!1),ne=(0,r.Z)(ee,2),te=ne[0],ie=ne[1];function ae(e){Q(!0),g.Z.getById(e).then((function(e){var n=(0,i.Z)((0,i.Z)((0,i.Z)({},e.data),function(e){if(null===e||void 0===e||!e.translations)return{};var n=e.translations,t=G.map((function(e){var t,i,a;return a={},(0,l.Z)(a,"title[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.title),(0,l.Z)(a,"description[".concat(e.locale,"]"),null===(i=n.find((function(n){return n.locale===e.locale})))||void 0===i?void 0:i.description),a}));return Object.assign.apply(Object,[{}].concat((0,a.Z)(t)))}(e.data)),{},{properties:e.data.properties.map((function(e,n){var t;return t={id:n},(0,l.Z)(t,"key[".concat(e.locale,"]"),e.key),(0,l.Z)(t,"value[".concat(e.locale,"]"),e.value),t})),translation:void 0,translations:void 0});K(n)})).finally((function(){return Q(!1)}))}(0,o.useEffect)((function(){M||ae(Y)}),[M]);var le=V.data,re=M?V.data.model:D;return J?(0,w.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,w.jsx)(m.Z,{size:"large",className:"py-5"})}):(0,w.jsxs)(u.Z,{children:[M&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(c.Z,{bordered:!0,title:A("changed.info"),children:[(0,w.jsx)(c.Z.Item,{label:"".concat(A("title")," (").concat($,")"),span:3,children:le["title[".concat($,"]")]}),(0,w.jsx)(c.Z.Item,{label:"".concat(A("description")," (").concat($,")"),span:3,children:le["description[".concat($,"]")]}),(0,w.jsx)(c.Z.Item,{label:A("shop"),span:1.5,children:null===le||void 0===le||null===(n=le.shop)||void 0===n?void 0:n.translation.title}),(0,w.jsx)(c.Z.Item,{label:A("category"),span:1.5,children:null===le||void 0===le||null===(t=le.category)||void 0===t?void 0:t.label}),(0,w.jsx)(c.Z.Item,{label:A("brand"),span:1.5,children:null===le||void 0===le||null===(I=le.brand)||void 0===I?void 0:I.label}),(0,w.jsx)(c.Z.Item,{label:A("unit"),span:1.5,children:null===le||void 0===le||null===(q=le.unit)||void 0===q?void 0:q.label}),(0,w.jsx)(c.Z.Item,{label:A("images"),span:3,children:(0,w.jsx)(d.Z,{gutter:12,children:null===le||void 0===le||null===(S=le.images)||void 0===S?void 0:S.map((function(e,n){return(0,w.jsx)(s.Z,{children:(0,w.jsx)("img",{width:80,alt:"product",src:e.url})},"image"+n)}))})}),(0,w.jsx)(c.Z.Item,{label:A("tax"),children:(null===le||void 0===le?void 0:le.tax)||0}),(0,w.jsx)(c.Z.Item,{label:A("min.quantity"),children:null===le||void 0===le?void 0:le.min_qty}),(0,w.jsx)(c.Z.Item,{label:A("max.quantity"),children:null===le||void 0===le?void 0:le.max_qty})]}),null===le||void 0===le?void 0:le.stocks.map((function(e,n){var t;return e?(0,w.jsxs)(c.Z,{bordered:!0,className:"mt-4",children:[(0,w.jsx)(c.Z.Item,{label:A("price"),span:2,children:e.price}),(0,w.jsx)(c.Z.Item,{label:A("quantity"),span:2,children:e.quantity}),null===e||void 0===e||null===(t=e.ids)||void 0===t?void 0:t.map((function(e,n){return(0,w.jsx)(c.Z.Item,{label:null===le||void 0===le?void 0:le.extras[n].label,children:null===e||void 0===e?void 0:e.label},"extra"+n)}))]},"desc"+n):""}))]}),(0,w.jsxs)(c.Z,{bordered:!0,className:"mt-4",title:A("original.info"),children:[(0,w.jsx)(c.Z.Item,{label:"".concat(A("title")," (").concat($,")"),span:3,column:3,children:(null===(C=re.translation)||void 0===C?void 0:C.title)||re["title[".concat($,"]")]}),(0,w.jsx)(c.Z.Item,{label:"".concat(A("description")," (").concat($,")"),span:3,column:3,children:(null===re||void 0===re||null===(_=re.translation)||void 0===_?void 0:_.description)||re["description[".concat($,"]")]}),(0,w.jsx)(c.Z.Item,{label:A("shop"),span:1.5,column:1.5,children:null===(N=re.shop)||void 0===N?void 0:N.translation.title}),(0,w.jsx)(c.Z.Item,{label:A("category"),span:1.5,column:1.5,children:null===(P=re.category)||void 0===P?void 0:P.translation.title}),(0,w.jsx)(c.Z.Item,{label:A("brand"),span:1.5,column:1.5,children:null===(E=re.brand)||void 0===E?void 0:E.title}),(0,w.jsx)(c.Z.Item,{label:A("unit"),span:1.5,column:1.5,children:null===(O=re.unit)||void 0===O?void 0:O.translation.title}),(0,w.jsx)(c.Z.Item,{label:A("images"),span:3,column:3,children:(0,w.jsx)(d.Z,{gutter:12,children:null===re||void 0===re||null===(F=re.galleries)||void 0===F?void 0:F.map((function(e,n){return(0,w.jsx)(s.Z,{children:(0,w.jsx)("img",{width:80,alt:"product",src:y.bV+e.path})},"image"+n)}))})}),(0,w.jsx)(c.Z.Item,{span:3,column:3,label:A("tax"),children:re.tax||0}),(0,w.jsx)(c.Z.Item,{span:3,column:3,label:A("min.quantity"),children:re.min_qty}),(0,w.jsx)(c.Z.Item,{span:3,column:3,label:A("max.quantity"),children:re.max_qty})]}),null===(U=re.stocks)||void 0===U?void 0:U.map((function(e,n){return e?(0,w.jsxs)(c.Z,{bordered:!0,className:"mt-4",children:[(0,w.jsx)(c.Z.Item,{label:A("price"),span:2,column:2,children:e.price}),(0,w.jsx)(c.Z.Item,{label:A("quantity"),span:2,column:2,children:e.quantity}),e.extras.map((function(e,n){var t,i;return(0,w.jsx)(c.Z.Item,{label:null===e||void 0===e||null===(t=e.group)||void 0===t||null===(i=t.translation)||void 0===i?void 0:i.title,span:2,column:2,children:null===e||void 0===e?void 0:e.value},"extra"+n)}))]},"desc"+n):""})),(0,w.jsx)("div",{className:"d-flex justify-content-end mt-4",children:(0,w.jsxs)(v.Z,{children:[(0,w.jsx)(f.Z,{onClick:L,children:A("prev")}),(0,w.jsx)(f.Z,{loading:te,type:"primary",onClick:function(){var e={status:void 0},n="catalog/products";if(M&&V.data){ie(!0);var t={id:V.data.model_id,type:"product",data:V.data};k.Z.requestChangeUpdate(V.data.request_id,t).then((function(){W("/".concat(n),{state:{tab:"request"}}),b.Am.success(A("successfully.updated")),z((0,h.ph)((0,i.Z)((0,i.Z)({},V),{},{nextUrl:n})))})).finally((function(){ie(!1)}))}else z((0,h.ph)((0,i.Z)((0,i.Z)({},V),{},{nextUrl:n}))),z((0,x.t2)(e)),W("/".concat(n))},children:A("finish")})]})})]})}},70432:function(e,n,t){t.d(n,{Z:function(){return C}});var i=t(93433),a=t(1413),l=t(29439),r=t(47313),o=t(10976),u=t(45705),c=t(59491),d=t(9274),s=t(55291),v=t(77181),f=t(68197),m=t(59624),p=t(66672),Z=t(78508),h=t(12019),x=t(47515),j=t(2717),g=t(73431),y=t(24511),b=t(46417);function k(e){var n=e.editData,t=e.handleCancel,i=e.editProperty,u=(0,y.$)().t,c=o.Z.useForm(),s=(0,l.Z)(c,1)[0],v=(0,j.v9)((function(e){return e.formLang}),j.wU),Z=v.defaultLang,h=v.languages;return(0,r.useEffect)((function(){s.setFieldsValue(n)}),[n]),(0,b.jsxs)(d.Z,{title:"Edit product property",visible:!!n,okText:"Save",onCancel:t,onOk:function(){return s.submit()},children:[(0,b.jsx)(f.Z,{className:"mb-3",children:(0,b.jsx)(m.Z,{span:24,children:(0,b.jsx)(g.Z,{})})}),(0,b.jsx)(o.Z,{form:s,layout:"vertical",onFinish:function(e){var t=(0,a.Z)((0,a.Z)({},n),e);i(t)},children:(0,b.jsxs)(f.Z,{className:"mt-4",children:[(0,b.jsx)(m.Z,{span:24,children:h.map((function(e){return(0,b.jsx)(o.Z.Item,{label:"Key",name:"key[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==Z?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(u("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}}],hidden:e.locale!==Z,children:(0,b.jsx)(p.Z,{})},"key"+e.locale)}))}),(0,b.jsx)(m.Z,{span:24,children:h.map((function(e){return(0,b.jsx)(o.Z.Item,{label:"Value",name:"value[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==Z?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(u("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}}],hidden:e.locale!==Z,children:(0,b.jsx)(p.Z,{})},"value"+e.locale)}))})]})})]})}var w=t(90954),I=t(17101),q=t(97890),S=t(55940),C=function(e){var n,t=e.next,g=e.prev,C=e.isRequest,_=(0,y.$)().t,N=(0,j.I0)(),P=(0,q.UO)().uuid,E=(0,j.v9)((function(e){return e.menu}),j.wU).activeMenu,O=(0,j.v9)((function(e){return e.formLang}),j.wU),F=O.defaultLang,U=O.languages,L=o.Z.useForm(),M=(0,l.Z)(L,1)[0],A=(0,r.useState)(null),V=(0,l.Z)(A,2),T=V[0],$=V[1],G=(0,r.useState)((null===(n=E.data)||void 0===n?void 0:n.properties)||[]),W=(0,l.Z)(G,2),z=W[0],R=W[1],B=(0,r.useState)(!1),D=(0,l.Z)(B,2),K=D[0],H=D[1],X=[{key:"2",title:_("key"),render:function(e,n){return n["key[".concat(F,"]")]}},{key:"4",title:_("value"),render:function(e,n){return n["value[".concat(F,"]")]}},{key:"5",title:_("options"),render:function(e){return(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(c.Z,{type:"primary",icon:(0,b.jsx)(h.Z,{}),onClick:function(){return $(e)}}),(0,b.jsx)(S.Z,{type:"primary",danger:!0,icon:(0,b.jsx)(x.Z,{}),onClick:function(){return J(e)}})]})}}];(0,r.useEffect)((function(){if(z.length&&P){var e=z;N((0,w.nc)({activeMenu:E,data:(0,a.Z)((0,a.Z)({},E.data),{},{properties:e})}))}}),[z]);var J=function(e){d.Z.confirm({title:_("delete.product"),okText:_("yes"),okType:"danger",onOk:function(){R((function(n){return n.filter((function(n){return n.id!==e.id}))}))}})},Q=function(){return $(null)};return(0,b.jsxs)(v.Z,{children:[(0,b.jsx)(o.Z,{layout:"vertical",form:M,onFinish:function(e){var n=parseInt(50*Math.random()),t=(0,a.Z)((0,a.Z)({},e),{},{id:n});R((function(e){return[].concat((0,i.Z)(e),[t])})),M.resetFields()},children:(0,b.jsxs)(f.Z,{gutter:12,className:"mb-3",children:[(0,b.jsx)(m.Z,{span:8,children:U.map((function(e){return(0,b.jsx)(o.Z.Item,{name:"key[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==F?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(_("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(_("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(_("required")))}}],hidden:e.locale!==F,children:(0,b.jsx)(p.Z,{placeholder:"Key"})},"key"+e.locale)}))}),(0,b.jsx)(m.Z,{span:8,children:U.map((function(e){return(0,b.jsx)(o.Z.Item,{name:"value[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==F?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(_("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(_("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(_("required")))}}],hidden:e.locale!==F,children:(0,b.jsx)(p.Z,{placeholder:_("value")})},"value"+e.locale)}))}),(0,b.jsx)(m.Z,{span:4,children:(0,b.jsx)(c.Z,{type:"primary",htmlType:"submit",children:_("save")})})]})}),(0,b.jsx)(Z.Z,{scroll:{x:!0},columns:X,dataSource:z,pagination:!1,rowKey:function(e){return e.id}}),T&&(0,b.jsx)(k,{editData:T,handleCancel:Q,editProperty:function(e){R((function(n){return n.map((function(n){return n.id===e.id?e:n}))})),Q()}}),(0,b.jsxs)(u.Z,{className:"mt-4",children:[(0,b.jsx)(c.Z,{onClick:g,children:_("prev")}),(0,b.jsx)(c.Z,{type:"primary",onClick:function(){var e=function(){var e=[],n=[];return z.forEach((function(t){var i={},a={};U.forEach((function(e){i[e.locale]=t["key[".concat(e.locale,"]")],a[e.locale]=t["value[".concat(e.locale,"]")]})),e.push(i),n.push(a)})),{key:e,value:n}}();if(C)return N((0,w.nc)({activeMenu:E,data:(0,a.Z)((0,a.Z)({},E.data),{},{properties:z,props:e})})),void t();H(!0),I.Z.properties(P,e).then((function(){s.ZP.success(_("product.properties.saved")),t()})).finally((function(){return H(!1)}))},loading:K,children:_("next")})]})]})}},8597:function(e,n,t){var i=t(4942),a=t(93433),l=t(1413),r=t(29439),o=t(47313),u=t(10976),c=t(77181),d=t(68197),s=t(59624),v=t(74294),f=t(66672),m=t(16124),p=t(59491),Z=t(45705),h=t(2717),x=t(47515),j=t(17101),g=t(24511),y=t(97890),b=t(89281),k=t(51282),w=t(33724),I=t(90954),q=t(46417);n.Z=function(e){var n,t=e.prev,S=e.next,C=e.isRequest,_=(0,g.$)().t,N=u.Z.useForm(),P=(0,r.Z)(N,1)[0],E=(0,y.UO)().uuid,O=(0,h.v9)((function(e){return e.menu}),h.wU).activeMenu,F=(0,o.useState)(null),U=(0,r.Z)(F,2),L=U[0],M=U[1],A=(0,o.useState)(null),V=(0,r.Z)(A,2),T=V[0],$=V[1],G=(0,o.useState)([]),W=(0,r.Z)(G,2),z=W[0],R=W[1],B=(0,h.I0)(),D=(0,y.TH)(),K=(0,h.v9)((function(e){return e.formLang}),h.wU).defaultLang,H=(0,h.v9)((function(e){return e.currency}),h.wU).defaultCurrency;var X=function(e){var n,t={search:e,addon:1,shop_id:null===O||void 0===O||null===(n=O.data)||void 0===n?void 0:n.shop_id,"statuses[0]":"published","statuses[1]":"pending",active:1};return j.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:null===e||void 0===e?void 0:e.id}}))}))};return(0,o.useEffect)((function(){var e;if(C)if(null!==(e=D.state)&&void 0!==e&&e.generate){var n,t,r,o,u,c,d=(0,w.Z)(null===O||void 0===O||null===(n=O.data.extras)||void 0===n?void 0:n.map((function(e){return e.values||[]}))),s=d.map((function(e){var n,t;if(e.every((function(e){return"undefined"!==typeof e.stock_id}))){var r,o,u,c=null===(r=O.data)||void 0===r||null===(o=r.actualStocks)||void 0===o?void 0:o.find((function(n){return n.extras.every((function(n){return e.some((function(e){return e.value===n.id}))}))})),d=[];return null===c||void 0===c||null===(u=c.addons)||void 0===u||u.forEach((function(e){var n,t,i;e.product&&d.push({label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)})})),(0,l.Z)({price:(null===c||void 0===c?void 0:c.price)||0,quantity:(null===c||void 0===c?void 0:c.quantity)||0,stock_id:null===c||void 0===c?void 0:c.id,tax:(null===O||void 0===O?void 0:O.data.tax)||0,addons:d},Object.assign.apply(Object,[{}].concat((0,a.Z)(e.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value,group:O.data.extras[n].label})}))))))}return(0,l.Z)({price:0,quantity:0,tax:(null===(n=O.data)||void 0===n?void 0:n.tax)||0,sku:null===O||void 0===O||null===(t=O.data)||void 0===t?void 0:t.sku,addons:[]},Object.assign.apply(Object,[{}].concat((0,a.Z)(e.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value})}))))))})),v=[];if(0===d.length&&0!==(null===(t=O.data)||void 0===t||null===(r=t.actualStocks)||void 0===r?void 0:r.length)){var f,m,p,Z=null===(f=O.data.actualStocks)||void 0===f?void 0:f.at(0),h=[];null===Z||void 0===Z||null===(m=Z.addons)||void 0===m||m.forEach((function(e){var n,t,i;e.product&&h.push({label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)})})),v=[{price:(null===Z||void 0===Z?void 0:Z.price)||0,quantity:(null===Z||void 0===Z?void 0:Z.quantity)||0,sku:null===Z||void 0===Z?void 0:Z.sku,tax:(null===(p=O.data)||void 0===p?void 0:p.tax)||0,addons:Z?h:[]}]}if(0===d.length&&0===(null===O||void 0===O||null===(o=O.data)||void 0===o||null===(u=o.actualStocks)||void 0===u?void 0:u.length))v=[{price:void 0,quantity:0,sku:null===O||void 0===O?void 0:O.data.sku,tax:(null===(c=O.data)||void 0===c?void 0:c.tax)||0,addons:[]}];var x=v.concat(s);R(O.data.actualStocks.map((function(e){return e.id}))),P.setFieldsValue({stocks:x})}else{var g,y,b=null===(g=O.data.stocks)||void 0===g?void 0:g.map((function(e){var n;return(0,l.Z)((0,l.Z)({price:e.price,quantity:e.quantity,tax:O.data.tax,stock_id:e.stock_id,sku:e.sku},Object.assign.apply(Object,[{}].concat((0,a.Z)(null===(n=e.ids)||void 0===n?void 0:n.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value,group:e.group})})))))),{},{addons:e.addons})}));R((null===(y=O.data)||void 0===y?void 0:y.delete_ids)||[]),P.setFieldsValue({stocks:b})}else!function(e){$(!0),j.Z.getById(e).then((function(e){var n,t,r,o,u,c=(0,w.Z)(null===O||void 0===O||null===(n=O.data.extras)||void 0===n?void 0:n.map((function(e){return e.values||[]}))),d=c.map((function(n,t){var r,o;if(n.every((function(e){return"undefined"!==typeof e.stock_id}))){var u,c=e.data.stocks.find((function(e){return e.extras.every((function(e){return n.some((function(n){return n.value===e.id}))}))})),d=[];return null===c||void 0===c||null===(u=c.addons)||void 0===u||u.forEach((function(e){var n,t,i;e.product&&d.push({label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)})})),(0,l.Z)({price:(null===c||void 0===c?void 0:c.price)||0,quantity:(null===c||void 0===c?void 0:c.quantity)||0,sku:null===c||void 0===c?void 0:c.sku,stock_id:null===c||void 0===c?void 0:c.id,tax:(null===O||void 0===O?void 0:O.data.tax)||0,addons:d},Object.assign.apply(Object,[{}].concat((0,a.Z)(n.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value})}))))))}return(0,l.Z)({price:0,quantity:0,sku:null===O||void 0===O||null===(r=O.data)||void 0===r?void 0:r.sku,tax:(null===(o=O.data)||void 0===o?void 0:o.tax)||0,addons:[]},Object.assign.apply(Object,[{}].concat((0,a.Z)(n.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value})}))))))})),s=[];if(0===c.length&&0!==(null===(t=e.data.stocks)||void 0===t?void 0:t.length)){var v,f,m,p=null===(v=e.data.stocks)||void 0===v?void 0:v.at(0),Z=[];null===p||void 0===p||null===(f=p.addons)||void 0===f||f.forEach((function(e){var n,t,i;e.product&&Z.push({label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)})})),s=[{price:(null===p||void 0===p?void 0:p.price)||0,quantity:(null===p||void 0===p?void 0:p.quantity)||0,sku:null===p||void 0===p?void 0:p.sku,tax:(null===(m=O.data)||void 0===m?void 0:m.tax)||0,addons:p?Z:[]}]}0===c.length&&0===(null===(r=e.data.stocks)||void 0===r?void 0:r.length)&&(s=[{price:void 0,quantity:0,sku:null===O||void 0===O||null===(o=O.data)||void 0===o?void 0:o.sku,tax:(null===(u=O.data)||void 0===u?void 0:u.tax)||0,addons:[]}]);var h=s.concat(d);R(e.data.stocks.map((function(e){return e.id}))),P.setFieldsValue({stocks:h})})).finally((function(){$(!1)}))}(E)}),[C,null===(n=D.state)||void 0===n?void 0:n.generate]),(0,q.jsx)(c.Z,{title:O.data["title[".concat(K,"]")]?'"'.concat(O.data["title[".concat(K,"]")],'"'):"",children:T?(0,q.jsx)(k.Z,{}):(0,q.jsxs)(u.Z,{layout:"vertical",form:P,onFinish:function(e){var n,t,i,a=e.stocks,r=z.filter((function(e,n){var t;return!(null===(t=a[n])||void 0===t||!t.stock_id)&&!a.some((function(n){return(null===n||void 0===n?void 0:n.stock_id)===e}))})),o=!(null===(n=O.data)||void 0===n||null===(t=n.extras)||void 0===t||!t.length);if(i=o?a.map((function(e,n){var t,i,a,l;return{price:e.price,quantity:e.quantity,sku:e.sku,ids:C?null===(t=O.data)||void 0===t?void 0:t.extras.map((function(n,t){return e["extras[".concat(t,"]")]})):null===(i=O.data)||void 0===i?void 0:i.extras.map((function(n,t){return e["extras[".concat(t,"]")].value})),addons:e.addons?C?null===(a=e.addons)||void 0===a?void 0:a.map((function(e){return e})):null===(l=e.addons)||void 0===l?void 0:l.map((function(e){return e.value})):[],stock_id:e.stock_id}})):[{price:a[0].price,quantity:a[0].quantity,addons:a[0].addons?C?a[0].addons.map((function(e){return e})):a[0].addons.map((function(e){return e.value})):[],stock_id:a[0].stock_id,sku:a[0].sku,ids:[]}],C)return B((0,I.nc)({activeMenu:O,data:(0,l.Z)((0,l.Z)({},O.data),{},{stocks:i,delete_ids:r})})),void S();M(!0),j.Z.stocks(E,{extras:i,delete_ids:r}).then((function(){B((0,I.nc)({activeMenu:O,data:(0,l.Z)((0,l.Z)({},O.data),{},{stocks:i,delete_ids:r})})),S()})).finally((function(){return M(!1)}))},children:[(0,q.jsx)(u.Z.List,{name:"stocks",children:function(e,n){n.add;var t=n.remove;return(0,q.jsx)("div",{children:e.map((function(e,n){var i,a,l,r;return(0,q.jsxs)(d.Z,{gutter:12,align:"middle",style:{flexWrap:"nowrap",overflowX:"auto"},hidden:!(null!==(i=O.data)&&void 0!==i&&null!==(a=i.extras)&&void 0!==a&&a.length)&&e.key,children:[null===(l=O.data)||void 0===l||null===(r=l.extras)||void 0===r?void 0:r.map((function(e,t){return(0,q.jsx)(s.Z,{children:(0,q.jsx)(u.Z.Item,{label:null===e||void 0===e?void 0:e.label,name:[n,"extras[".concat(t,"]")],rules:[{required:!0,message:_("required")}],children:(0,q.jsx)(v.Z,{disabled:!0,className:"w-100",style:{minWidth:200}})})},"extra"+e.value)})),(0,q.jsx)(s.Z,{children:(0,q.jsx)(u.Z.Item,{label:_("addons"),name:[n,"addons"],rules:[{required:!1,message:_("required")}],children:(0,q.jsx)(b.h,{mode:"multiple",style:{minWidth:"300px"},fetchOptions:X,allowClear:!0})})}),(0,q.jsx)(s.Z,{children:(0,q.jsx)(u.Z.Item,{label:_("sku"),name:[n,"sku"],children:(0,q.jsx)(f.Z,{className:"w-100",style:{minWidth:200}})})}),(0,q.jsx)(s.Z,{children:(0,q.jsx)(u.Z.Item,{label:_("quantity"),name:[n,"quantity"],rules:[{required:!0,message:_("required")}],children:(0,q.jsx)(m.Z,{min:0,className:"w-100",style:{minWidth:200}})})}),(0,q.jsxs)(s.Z,{children:[(0,q.jsx)(u.Z.Item,{label:"".concat(_("price")," (").concat(null===H||void 0===H?void 0:H.symbol,")"),name:[n,"price"],rules:[{required:!0,message:_("requried")}],children:(0,q.jsx)(m.Z,{min:0,className:"w-100",style:{minWidth:200}})}),(0,q.jsx)(u.Z.Item,{hidden:!0,label:_("id"),name:[n,"stock_id"],children:(0,q.jsx)(m.Z,{min:1,className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,q.jsx)(s.Z,{children:(0,q.jsx)(u.Z.Item,{label:_("tax"),name:[n,"tax"],children:(0,q.jsx)(m.Z,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})}),(0,q.jsx)(s.Z,{children:(0,q.jsx)(u.Z.Item,{noStyle:!0,shouldUpdate:function(n,t){var i,a;return(null===(i=n.stocks[e.name])||void 0===i?void 0:i.price)!==(null===(a=t.stocks[e.name])||void 0===a?void 0:a.price)},children:function(n){var t=n.getFieldValue,i=t(["stocks",e.name,"tax"])||0,a=t(["stocks",e.name,"price"]),l=0===i?a:a*i/100+a;return(0,q.jsx)(u.Z.Item,{label:"".concat(_("total.price")," (").concat(null===H||void 0===H?void 0:H.symbol,")"),children:(0,q.jsx)(m.Z,{min:1,disabled:!0,value:l,className:"w-100",style:{minWidth:200}})})}})}),(0,q.jsx)(s.Z,{children:e.key?(0,q.jsx)(p.Z,{type:"primary",className:"mt-2",danger:!0,icon:(0,q.jsx)(x.Z,{}),onClick:function(){t(e.name)}}):""})]},e.key)}))})}}),(0,q.jsxs)(Z.Z,{className:"mt-4",children:[(0,q.jsx)(p.Z,{onClick:t,children:_("prev")}),(0,q.jsx)(p.Z,{type:"primary",htmlType:"submit",loading:!!L,children:_("next")})]})]})})}},97307:function(e,n,t){var i=t(4942),a=t(93433),l=t(15861),r=t(1413),o=t(29439),u=t(87757),c=t.n(u),d=t(47313),s=t(10976),v=t(68197),f=t(59624),m=t(77181),p=t(66672),Z=t(16124),h=t(86345),x=t(59491),j=t(89281),g=t(53149),y=t(11216),b=t(30763),k=t(2717),w=t(17101),I=t(90954),q=t(31055),S=t(97890),C=t(24511),_=t(5764),N=t(49080),P=t(13622),E=t(82138),O=t(20776),F=t(46417);n.Z=function(e){var n,t,u,U=e.next,L=e.action_type,M=void 0===L?"":L,A=e.isRequest,V=(0,C.$)().t,T=s.Z.useForm(),$=(0,o.Z)(T,1)[0],G=s.Z.useWatch("shop",$),W=(0,k.I0)(),z=(0,S.UO)().uuid,R=(0,S.s0)(),B=(0,d.useState)(null),D=(0,o.Z)(B,2),K=D[0],H=D[1],X=(0,k.v9)((function(e){return e.menu}),k.wU).activeMenu,J=(0,k.v9)((function(e){return e.formLang}),k.wU),Q=J.defaultLang,Y=J.languages,ee=(0,d.useState)(null!==(n=X.data)&&void 0!==n&&n.images?null===(t=X.data)||void 0===t?void 0:t.images:[]),ne=(0,o.Z)(ee,2),te=ne[0],ie=ne[1],ae=(0,d.useState)(!1),le=(0,o.Z)(ae,2),re=le[0],oe=le[1],ue=(0,d.useState)([]),ce=(0,o.Z)(ue,2),de=(ce[0],ce[1]),se=(0,d.useState)(Boolean(null===(u=X.data)||void 0===u?void 0:u.kcal)),ve=(0,o.Z)(se,2),fe=ve[0],me=ve[1];function pe(){return(pe=(0,l.Z)(c().mark((function e(n){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,active:1},e.abrupt("return",g.Z.get(t).then((function(e){return e.data.map((function(e){return{label:e.translation?e.translation.title:"no name",value:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(){return(Ze=(0,l.Z)(c().mark((function e(n){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={perPage:10,type:"main",search:n,active:1},e.abrupt("return",y.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:e.title,value:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){return(he=(0,l.Z)(c().mark((function e(n){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={perPage:10,type:"main",search:n,shop_id:null===G||void 0===G?void 0:G.value,"statuses[0]":"pending","statuses[1]":"published",active:1},e.abrupt("return",b.Z.selectPaginate(t).then((function(e){return e.data.map((function(e){var n,t;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"",value:e.id,key:e.id,disabled:e.children.length>0,children:null===(t=e.children)||void 0===t?void 0:t.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"",value:e.id,key:e.id}}))}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,d.useEffect)((function(){var e=$.getFieldsValue(!0);W((0,I.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)({},X.data),e)}))}),[]);function xe(e){var n={perPage:10,page:1,active:1,search:e};return q.Z.getAll(n).then((function(e){var n=e.data;return de(function(e){return e.map((function(e){var n;return{label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id}}))}(n)),null===n||void 0===n?void 0:n.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:null===e||void 0===e?void 0:e.id}}))}))}(0,d.useEffect)((function(){xe()}),[]);var je=function(){W((0,I.bL)({id:"category-add",url:"category/add",name:V("add.category")})),R("/category/add")};return(0,F.jsxs)(s.Z,{layout:"vertical",form:$,initialValues:(0,r.Z)({active:!0,vegetarian:!0},X.data),onFinish:function(e){var n,t,l,o;oe(!0);var u=(0,r.Z)((0,r.Z)({},e),{},{active:Number(e.active),vegetarian:Number(e.vegetarian),brand_id:null===(n=e.brand)||void 0===n?void 0:n.value,category_id:(null===(t=e.category)||void 0===t?void 0:t.value)||e.category,shop_id:null===(l=e.shop)||void 0===l?void 0:l.value,unit_id:null===(o=e.unit)||void 0===o?void 0:o.value,kcal:fe?String(e.kcal):void 0,carbs:fe?String(e.carbs):void 0,protein:fe?String(e.protein):void 0,fats:fe?String(e.fats):void 0,images:void 0,brand:void 0,category:void 0,shop:void 0,unit:void 0,tax:e.tax||0},Object.assign.apply(Object,[{}].concat((0,a.Z)(te.map((function(e,n){return(0,i.Z)({},"images[".concat(n,"]"),e.name)}))))));if(A)return W((0,I.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)((0,r.Z)({},X.data),u),{},{images:te,brand:e.brand,category:e.category,shop:e.shop,unit:e.unit,tax:e.tax||0,title:(0,r.Z)({},Object.assign.apply(Object,[{}].concat((0,a.Z)(Y.map((function(n){return(0,i.Z)({},n.locale,e["title[".concat(n.locale,"]")])})))))),description:(0,r.Z)({},Object.assign.apply(Object,[{}].concat((0,a.Z)(Y.map((function(n){return(0,i.Z)({},n.locale,e["description[".concat(n.locale,"]")])}))))))})})),void U();"edit"===M?function(e,n){w.Z.update(z,n).then((function(){W((0,I.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)({},e),null===X||void 0===X?void 0:X.data)})),U()})).catch((function(e){return H(e.response.data.params)})).finally((function(){return oe(!1)}))}(e,u):function(e,n){w.Z.create(n).then((function(n){var t=n.data;W((0,I.SS)({id:"product-".concat(t.uuid),url:"product/".concat(t.uuid),name:V("add.product"),data:e,refetch:!1})),R("/product/".concat(t.uuid,"/?step=1"))})).catch((function(e){return H(e.response.data.params)})).finally((function(){return oe(!1)}))}(e,u)},children:[(0,F.jsxs)(v.Z,{gutter:12,children:[(0,F.jsx)(f.Z,{span:16,children:(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(m.Z,{title:V("basic.info"),children:(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(f.Z,{span:24,children:Y.map((function(e){return(0,F.jsx)(s.Z.Item,{label:V("name"),name:"title[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==Q?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(V("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(V("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(V("required")))}}],hidden:e.locale!==Q,children:(0,F.jsx)(p.Z,{})},"name"+e.id)}))}),(0,F.jsx)(f.Z,{span:24,children:Y.map((function(e){return(0,F.jsx)(s.Z.Item,{label:V("description"),name:"description[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==Q?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(V("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<5?Promise.reject(new Error(V("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(V("required")))}}],hidden:e.locale!==Q,children:(0,F.jsx)(N.Z,{rows:3})},"description"+e.id)}))})]})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(m.Z,{title:V("pricing"),children:(0,F.jsxs)(v.Z,{gutter:12,children:[(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("min.qty"),name:"min_qty",rules:[{required:!0,message:V("required")}],children:(0,F.jsx)(Z.Z,{min:0,className:"w-100"})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("max.qty"),name:"max_qty",rules:[{required:!0,message:V("required")}],children:(0,F.jsx)(Z.Z,{min:0,className:"w-100"})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("tax"),name:"tax",rules:[{validator:function(e,n){return n&&(n<0||n>100)?Promise.reject(new Error(V("must.be.between.0.and.100"))):Promise.resolve()}}],children:(0,F.jsx)(Z.Z,{className:"w-100",addonAfter:"%"})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("interval.unit"),name:"interval",rules:[{required:!0,message:V("required")},{type:"number",min:0,message:V("must.be.positive")}],help:null!==K&&void 0!==K&&K.interval?K.interval[0]:null,validateStatus:null!==K&&void 0!==K&&K.interval?"error":"success",children:(0,F.jsx)(Z.Z,{className:"w-100"})})})]})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(m.Z,{title:V("additions"),children:(0,F.jsxs)(v.Z,{gutter:12,children:[(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("active"),name:"active",valuePropName:"checked",children:(0,F.jsx)(h.Z,{})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("vegetarian"),name:"vegetarian",valuePropName:"checked",children:(0,F.jsx)(h.Z,{})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{label:V("nutrition.".concat(fe?"on":"off")),valuePropName:"checked",children:(0,F.jsx)(h.Z,{checked:fe,onChange:function(e){return me(e)}})})})]})})}),fe&&(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(m.Z,{title:V("nutritional.value.of.product"),children:(0,F.jsxs)(v.Z,{gutter:12,children:[(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{rules:[{required:!0,message:V("required")}],label:V("kcal"),name:"kcal",children:(0,F.jsx)(Z.Z,{min:0,max:10,className:"w-100"})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{rules:[{required:!0,message:V("required")}],label:V("carbs"),name:"carbs",children:(0,F.jsx)(Z.Z,{min:0,max:10,className:"w-100"})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{rules:[{required:!0,message:V("required")}],label:V("protein"),name:"protein",children:(0,F.jsx)(Z.Z,{min:0,max:10,className:"w-100"})})}),(0,F.jsx)(f.Z,{span:6,children:(0,F.jsx)(s.Z.Item,{rules:[{required:!0,message:V("required")}],label:V("fats"),name:"fats",children:(0,F.jsx)(Z.Z,{min:0,max:10,className:"w-100"})})})]})})})]})}),(0,F.jsx)(f.Z,{span:8,children:(0,F.jsxs)(v.Z,{children:[(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(m.Z,{title:V("organization"),children:(0,F.jsxs)(v.Z,{children:[!A&&(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(s.Z.Item,{label:V("shop/restaurant"),name:"shop",rules:[{required:!0,message:V("required")}],children:(0,F.jsx)(P.R,{fetchOptions:function(e){return pe.apply(this,arguments)},onChange:function(){return $.setFieldsValue({category:void 0})}})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(s.Z.Item,{label:V("category"),name:"category",rules:[{required:!0,message:V("required")}],children:(0,F.jsx)(O.o,{disabled:!(null!==G&&void 0!==G&&G.value),refetch:!0,fetchOptions:function(e){return he.apply(this,arguments)},dropdownRender:function(e){return(0,F.jsxs)(F.Fragment,{children:[e,(0,F.jsx)("div",{className:"p-1",children:(0,F.jsx)(x.Z,{icon:(0,F.jsx)(E.Z,{}),className:"w-100",onClick:je,children:V("add.category")})})]})}})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(s.Z.Item,{label:V("brand"),name:"brand",children:(0,F.jsx)(j.h,{fetchOptions:function(e){return Ze.apply(this,arguments)}})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(s.Z.Item,{label:V("unit"),name:"unit",rules:[{required:!0,message:V("required")}],children:(0,F.jsx)(j.h,{fetchOptions:xe})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(s.Z.Item,{label:V("sku"),name:"sku",children:(0,F.jsx)(p.Z,{className:"w-100"})})})]})})}),(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(m.Z,{title:V("media"),children:(0,F.jsx)(v.Z,{children:(0,F.jsx)(f.Z,{span:24,children:(0,F.jsx)(s.Z.Item,{name:"images",rules:[{validator:function(e,n){return 0===te.length?Promise.reject(new Error(V("required"))):Promise.resolve()}}],children:(0,F.jsx)(_.Z,{type:"products",imageList:te,setImageList:ie,form:$,multiple:!0})})})})})})]})})]}),(0,F.jsx)(x.Z,{type:"primary",htmlType:"submit",loading:re,children:V("next")})]})}},96077:function(e,n,t){t.d(n,{S:function(){return i}});var i=[{title:"product",content:"First-content"},{title:"product.extras",content:"Second-content"},{title:"stocks",content:"Third-content"},{title:"product.property",content:"Fourth-content"},{title:"finish",content:"Finish-content"}]}}]);