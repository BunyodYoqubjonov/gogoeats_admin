"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5602],{15602:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var l=t(4942),i=t(93433),d=t(1413),o=t(29439),a=t(47313),u=t(47548),r=t(31741),s=t(12019),c=t(66407),f=t(47515),v=t(55768),h=t(73591),m=t(45705),x=t(59491),Z=t(77181),j=t(78508),p=t(97890),g=t(2717),_=t(84304),b=t(13945),y=t(90954),C=t(80314),w=t(91405),k=t(24511),S=t(10310),A=t(41481),I=t(53233),M=t(55940),P=t(74580),L=t(23560),N=t(45321),T=t(69658),U=t(48008),z=t(26672),K=t(49986),O=t(79492),D=t(46417),V=h.Z.TabPane,E=["admin","seller","moderator","manager","cook","deliveryman","waiter","deleted_at"];function F(){var e,n,t,F,R,$,q,B=(0,k.$)().t,G=(0,g.I0)(),H=(0,p.s0)(),J=(0,a.useState)(null),Q=(0,o.Z)(J,2),W=Q[0],X=Q[1],Y=(0,a.useState)(null),ee=(0,o.Z)(Y,2),ne=ee[0],te=ee[1],le=(0,a.useContext)(P._).setIsModalVisible,ie=(0,a.useState)(!1),de=(0,o.Z)(ie,2),oe=de[0],ae=de[1],ue=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,re=(0,g.v9)((function(e){return e.user}),g.wU),se=re.users,ce=re.loading,fe=re.meta,ve=re.params,he=(0,a.useState)(null),me=(0,o.Z)(he,2),xe=me[0],Ze=me[1],je=(0,a.useState)(null),pe=(0,o.Z)(je,2),ge=pe[0],_e=pe[1],be=(0,a.useState)("admin"),ye=(0,o.Z)(be,2),Ce=ye[0],we=ye[1],ke=(0,a.useState)(null),Se=(0,o.Z)(ke,2),Ae=Se[0],Ie=Se[1],Me=(null===(e=ue.data)||void 0===e?void 0:e.role)||Ce,Pe=(0,g.v9)((function(e){return e.auth}),g.wU).user,Le=(0,O.Z)(),Ne=Le.isDemo,Te=Le.demoDeliveryman,Ue=Le.demoSeller,ze=Le.demoAdmin,Ke=Le.demoModerator,Oe=Le.demoMeneger,De=ue.data,Ve="deleted_at"===Me?{deleted_at:1,role:null}:{role:Me},Ee=(0,d.Z)((0,d.Z)({sort:null===De||void 0===De?void 0:De.sort,column:null===De||void 0===De?void 0:De.column},Ve),{},{perPage:null===De||void 0===De?void 0:De.perPage,page:null===De||void 0===De?void 0:De.page,search:null===De||void 0===De?void 0:De.search}),Fe=(0,a.useState)([{title:B("id"),dataIndex:"id",sorter:!0,is_show:!0},{title:B("firstname"),dataIndex:"firstname",is_show:!0},{title:B("lastname"),dataIndex:"lastname",is_show:!0},{title:B("email"),dataIndex:"email",is_show:!0,render:function(e){return(0,D.jsx)("div",{children:Ne?"":e})}},{title:B("role"),dataIndex:"role",is_show:!0},{title:B("options"),dataIndex:"options",is_show:!0,render:function(e,n){return(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(x.Z,{icon:(0,D.jsx)(u.Z,{}),onClick:function(){return Ze(n.uuid)},disabled:null===n||void 0===n?void 0:n.deleted_at}),"manager"===Pe.role&&"admin"===n.role?void 0:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(x.Z,{icon:(0,D.jsx)(r.Z,{}),onClick:function(){return function(e){G((0,y.bL)({url:"/users/user/".concat(e.uuid),id:"user_info",name:B("user.info")})),H("/users/user/".concat(e.uuid),{state:{user_id:e.id}})}(n)},disabled:null===n||void 0===n?void 0:n.deleted_at}),(0,D.jsx)(x.Z,{type:"primary",icon:(0,D.jsx)(s.Z,{}),onClick:function(){return function(e){G((0,y.bL)({url:"user/".concat(e.uuid),id:"user_edit",name:"User edit"})),H("/user/".concat(e.uuid))}(n)},disabled:Ne&&(null===n||void 0===n?void 0:n.id)==Te||Ne&&(null===n||void 0===n?void 0:n.id)==Ke||Ne&&(null===n||void 0===n?void 0:n.id)==Oe||Ne&&(null===n||void 0===n?void 0:n.id)==Ue||Ne&&(null===n||void 0===n?void 0:n.id)==ze||(null===n||void 0===n?void 0:n.deleted_at)})]}),"admin"!==(null===n||void 0===n?void 0:n.role)&&(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(x.Z,{icon:(0,D.jsx)(c.Z,{}),onClick:function(){return function(e){G((0,y.bL)({url:"user-clone/".concat(e.uuid),id:"user-clone",name:"user.clone"})),H("/user-clone/".concat(e.uuid))}(n)},disabled:null===n||void 0===n?void 0:n.deleted_at}),(0,D.jsx)(M.Z,{icon:(0,D.jsx)(f.Z,{}),onClick:function(){X([n.id]),le(!0),te(!0)},disabled:null===n||void 0===n?void 0:n.deleted_at})]})]})}}]),Re=(0,o.Z)(Fe,2),$e=Re[0],qe=Re[1];(0,a.useEffect)((function(){ue.refetch&&(G((0,_.uh)(Ee)),G((0,y.A_)(ue)))}),[ue.refetch]),(0,C.Z)((function(){G((0,_.uh)(Ee))}),[ue.data]);var Be=function(e){var n=ue.data;G((0,y.nc)({activeMenu:ue,data:(0,d.Z)((0,d.Z)({},n),e)}))},Ge={selectedRowKeys:W,onChange:function(e){X(e)}};return(0,D.jsxs)(Z.Z,{title:B("users"),extra:(0,D.jsxs)(m.Z,{wrap:!0,children:["deleted_at"!==(null===(n=ue.data)||void 0===n?void 0:n.role)?(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(M.Z,{size:"",onClick:function(){null===W||0===W.length?L.Am.warning(B("select.the.product")):(le(!0),te(!1))},children:B("delete.selected")}),(0,D.jsx)(M.Z,{onClick:function(){return Ie({delete:!0})},children:B("delete.all")})]}):(0,D.jsx)(M.Z,{icon:(0,D.jsx)(z.uOc,{className:"mr-2"}),onClick:function(){return Ie({restore:!0})},children:B("restore.all")}),(0,D.jsx)(I.Z,{columns:$e,setColumns:qe})]}),children:[(0,D.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,D.jsx)(A.Z,{placeholder:B("search"),className:"w-25",handleChange:function(e){Be({search:e})},defaultValue:null===(t=ue.data)||void 0===t?void 0:t.search,resetSearch:!(null!==(F=ue.data)&&void 0!==F&&F.search)})}),(0,D.jsx)(h.Z,{scroll:{x:!0},activeKey:Me,onChange:function(e){Be({role:e,page:1}),we(e)},type:"card",children:E.map((function(e){return(0,D.jsx)(V,{tab:B(e)},e)}))}),"admin"!=Me&&"seller"!=Me&&"deleted_at"!=Me?(0,D.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,D.jsx)(x.Z,{type:"primary",icon:(0,D.jsx)(v.Z,{}),onClick:function(){return e=Me,G((0,y.bL)({id:"user-add-role",url:"user/add/".concat(e),name:B("add.".concat(e))})),void H("/user/add/".concat(e));var e},className:"mr-2",children:B("add.".concat(Me))})}):null,(0,D.jsx)(j.Z,{scroll:{x:!0},rowSelection:Ge,columns:null===$e||void 0===$e?void 0:$e.filter((function(e){return e.is_show})),dataSource:se,loading:ce,pagination:{pageSize:ve.perPage,page:(null===(R=ue.data)||void 0===R?void 0:R.page)||1,total:fe.total,defaultCurrent:null===($=ue.data)||void 0===$?void 0:$.page,current:null===(q=ue.data)||void 0===q?void 0:q.page},rowKey:function(e){return e.id},onChange:function(e,n,t){var l=e.pageSize,i=e.current,o=t.field,a=t.order,u=(0,b.Z)(a);G((0,y.nc)({activeMenu:ue,data:(0,d.Z)((0,d.Z)({},ue.data),{},{perPage:l,page:i,column:o,sort:u})}))}}),(0,D.jsx)(T.Z,{click:function(){ae(!0);var e=(0,d.Z)({},Object.assign.apply(Object,[{}].concat((0,i.Z)(W.map((function(e,n){return(0,l.Z)({},"ids[".concat(n,"]"),e)}))))));N.Z.delete(e).then((function(){L.Am.success(B("successfully.deleted")),G((0,_.uh)(Ee)),le(!1),te([])})).finally((function(){X(null),ae(!1)}))},text:B(ne?"delete":"all.delete"),loading:oe,setText:X}),xe&&(0,D.jsx)(w.Z,{uuid:xe,handleCancel:function(){return Ze(null)}}),ge&&(0,D.jsx)(S.Z,{data:ge,handleCancel:function(){return _e(null)}}),Ae&&(0,D.jsx)(U.Z,{open:Ae,handleCancel:function(){return Ie(null)},click:Ae.restore?function(){ae(!0),K.Z.restoreAll().then((function(){L.Am.success(B("successfully.restored")),G((0,_.uh)(Ee)),Ie(null)})).finally((function(){return ae(!1)}))}:function(){ae(!0),K.Z.dropAll().then((function(){L.Am.success(B("successfully.deleted")),G((0,_.uh)()),Ie(null)})).finally((function(){return ae(!1)}))},text:Ae.restore?B("restore.modal.text"):B("read.carefully"),subTitle:Ae.restore?"":B("confirm.deletion"),loading:oe,setText:te})]})}}}]);